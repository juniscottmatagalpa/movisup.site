<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Descargar Videos de Instagram HD</title>

<style>
html, body { margin:0; padding:0; background:#f3f3f3; font-family: Arial, sans-serif; }
.container { width: 100%; max-width: 600px; margin: auto; padding: 20px; }
input[type="text"]{
  width:100%; padding:14px; border-radius:8px; border:2px solid #ccc;
  font-size:16px; margin-top:15px;
}
button{
  width:100%; padding:14px; margin-top:15px; font-size:16px;
  border:none; border-radius:6px; cursor:pointer; background:#007aff; color:white;
}
#result{ display:none; margin-top:20px; background:white; padding:15px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
#thumb{ width:100%; border-radius:10px; }
#loader { display:none; font-size:18px; margin-top:15px; text-align:center; }
</style>

</head>

<body>

<div class="container">
  <h1>Descargar Videos de Instagram HD</h1>

  <input id="input" type="text" placeholder="Pega un enlace de Instagram aquí">

  <button onclick="obtenerInfo()">Obtener Video</button>

  <div id="loader">Cargando información...</div>

  <div id="result">
    <h3 id="title"></h3>
    <img id="thumb" src="">
    <button onclick="descargar()">Descargar Video</button>
  </div>
</div>


<script>
const input = document.getElementById("input");

// ⭐ TU API REAL EN VERCEL (ILIMITADA)
const API_INFO = "https://insta-api-mu-one.vercel.app/api/info";
const API_DOWNLOAD = "https://insta-api-mu-one.vercel.app/api/download";

// Mostrar / ocultar loader
function showLoader(show){
  document.getElementById("loader").style.display = show ? "block" : "none";
}

// ========= OBTENER INFORMACIÓN ==========
async function obtenerInfo(){
  const url = input.value.trim();
  if(!url) return alert("Ingrese un enlace válido");

  showLoader(true);

  try {
    const form = new URLSearchParams();
    form.append("q", url);

    const res = await fetch(API_INFO, {
      method: "POST",
      headers: { "Content-Type":"application/x-www-form-urlencoded; charset=UTF-8" },
      body: form.toString()
    });

    const data = await res.json();
    showLoader(false);

    if(data.error){
      return alert("❌ Error: " + data.error);
    }

    if(!data.data?.video?.length){
      return alert("❌ No se pudo extraer el video.");
    }

    document.getElementById("title").textContent = "Video listo para descargar";
    document.getElementById("thumb").src = data.data.thumbnail || "https://i.imgur.com/ufFES8A.jpeg";
    document.getElementById("result").style.display = "block";

  } catch (err) {
    showLoader(false);
    alert("Error al obtener datos: " + err);
  }
}


// ========= DESCARGAR VIDEO ==========
async function descargar(){
  const url = input.value.trim();
  if(!url) return alert("Ingrese un enlace válido");

  try {
    const form = new URLSearchParams();
    form.append("q", url);

    const res = await fetch(API_INFO, {
      method: "POST",
      headers: { "Content-Type":"application/x-www-form-urlencoded; charset=UTF-8" },
      body: form.toString()
    });

    const data = await res.json();

    if(!data.data?.video?.length){
      return alert("❌ No se encontró enlace de descarga");
    }

    const downloadUrl = data.data.video[0].url;

    // Abrir descarga desde tu API
    window.location.href =
      `${API_DOWNLOAD}?url=${encodeURIComponent(downloadUrl)}&ext=mp4`;

  } catch (err) {
    alert("Error en descarga: " + err);
  }
}

</script>

</body>
</html>

