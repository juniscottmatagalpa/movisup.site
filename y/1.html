<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Instagram Downloader</title>

<style>
  body {
    font-family: system-ui, Segoe UI, Roboto, Arial;
    background: #f6f8fb;
    color: #222;
    margin: 0;
    padding: 24px;
    display: flex;
    justify-content: center;
  }
  .card {
    width: 100%;
    max-width: 680px;
    background: #fff;
    padding: 22px;
    border-radius: 14px;
    box-shadow: 0 6px 24px rgba(16,24,40,0.08);
  }
  h1 { margin: 0 0 12px; color: #0ea5a1; }
  input {
    width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #e6e9ef;
    font-size: 15px;
  }
  .row { display: flex; gap: 10px; margin-top: 12px; }
  button {
    padding: 10px 14px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    color: #fff;
  }
  .btn-primary { background: #0ea5a1; }
  .btn-secondary { background: #2563eb; }
  .meta { display: flex; gap: 16px; margin-top: 18px; }
  .thumb {
    width: 170px;
    height: 170px;
    background: #eee;
    border-radius: 8px;
    object-fit: cover;
  }
  .info { flex: 1; }
  #title { font-size: 17px; font-weight: 700; margin: 0; }
  #desc { font-size: 14px; color: #444; white-space: pre-wrap; margin-top: 6px; }
  .downloads { display: flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }
  .btn-download {
    background: #10b981;
    padding: 10px 14px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    color: #fff;
    font-weight: 600;
  }
  .btn-low { background: #6366f1; }
  .btn-audio { background: #f97316; }
  #loader { display: none; margin-top: 14px; color: #666; font-size: 15px; }
  .error { color: #ef4444; margin-top: 10px; font-weight: 600; }
  .note { font-size: 14px; color: #777; margin-top: 10px; }
</style>
</head>

<body>
  <div class="card">
    <h1>Descargar Reels / Videos de Instagram</h1>
    <p>Pega el enlace p√∫blico de un Reel o publicaci√≥n con video:</p>

    <input id="urlInput" placeholder="https://www.instagram.com/reel/..." />
    <div class="row">
      <button id="btnGet" class="btn-primary">Obtener informaci√≥n</button>
      <button id="btnClear" class="btn-secondary">Limpiar</button>
    </div>

    <div id="loader">‚è≥ Cargando informaci√≥n...</div>
    <div id="error" class="error"></div>

    <div id="metaWrap" style="display:none;">
      <div class="meta">
        <img id="thumb" class="thumb" src="" alt="miniatura" />
        <div class="info">
          <p id="title"></p>
          <p id="desc"></p>

          <div class="downloads" id="downloads"></div>
        </div>
      </div>
      <p class="note">Si el bot√≥n de audio no convierte, el archivo ser√° descargado como el video original.</p>
    </div>
  </div>

<script>
const WORKER_URL = "https://youtub-lake-6929.juniscottmatagalpa.workers.dev";
const btnGet = document.getElementById('btnGet');
const btnClear = document.getElementById('btnClear');
const urlInput = document.getElementById('urlInput');
const loader = document.getElementById('loader');
const errorDiv = document.getElementById('error');
const metaWrap = document.getElementById('metaWrap');
const thumb = document.getElementById('thumb');
const titleEl = document.getElementById('title');
const descEl = document.getElementById('desc');
const downloads = document.getElementById('downloads');

btnGet.addEventListener('click', obtenerInfo);
btnClear.addEventListener('click', () => {
  urlInput.value = "";
  metaWrap.style.display = "none";
  errorDiv.textContent = "";
  downloads.innerHTML = "";
});

function showLoader(show){ loader.style.display = show ? "block" : "none"; }

async function obtenerInfo(){
  errorDiv.textContent = "";
  downloads.innerHTML = "";
  metaWrap.style.display = "none";

  const url = urlInput.value.trim();
  if(!url) return errorDiv.textContent = "Pega una URL de Instagram.";
  if(!/^https?:\/\/(www\.)?instagram\.com\//.test(url))
    return errorDiv.textContent = "URL no v√°lida. Debe ser instagram.com";

  showLoader(true);

  try {
    const params = new URLSearchParams();
    params.append('q', url);

    const res = await fetch(WORKER_URL, {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8" },
      body: params.toString()
    });

    const text = await res.text();
    let data;
    try { data = JSON.parse(text); }
    catch { throw new Error("Respuesta no v√°lida del servidor"); }

    showLoader(false);

    if(data.error) throw new Error(data.error);
    if(!data.videoUrl) throw new Error("No se encontr√≥ URL de video en la respuesta.");

    metaWrap.style.display = "block";
    thumb.src = data.thumbnail || "";
    titleEl.textContent = data.title || "Sin t√≠tulo";
    descEl.textContent = data.description || "";

    downloads.innerHTML = "";

    // Bot√≥n HD
    createDownload("üìπ Descargar HD", data.videoUrl, "mp4", "btn-download");
    // Bot√≥n baja calidad (mismo archivo, pero el usuario puede convertir)
    createDownload("üì• Descargar baja", data.videoUrl, "mp4", "btn-download btn-low");
    // Bot√≥n audio
    createDownload("üéµ Solo audio (MP3)", data.videoUrl, "mp3", "btn-download btn-audio");

  } catch(err) {
    showLoader(false);
    errorDiv.textContent = "‚ùå " + (err.message || "Error desconocido");
  }
}

function createDownload(text, videoUrl, ext, className){
  const btn = document.createElement("button");
  btn.textContent = text;
  btn.className = className;
  btn.onclick = () => startDownload(videoUrl, ext);
  downloads.appendChild(btn);
}

function startDownload(videoUrl, ext){
  const dl = `${WORKER_URL}?download=${encodeURIComponent(videoUrl)}&ext=${encodeURIComponent(ext)}`;
  window.location.href = dl;
}
</script>
</body>
</html>



